"use strict";(()=>{var e={};e.id=373,e.ids=[373],e.modules={8802:e=>{e.exports=require("bcrypt")},1185:e=>{e.exports=require("mongoose")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},4653:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>j,requestAsyncStorage:()=>x,routeModule:()=>g,serverHooks:()=>v,staticGenerationAsyncStorage:()=>_,staticGenerationBailout:()=>P});var s={};t.r(s),t.d(s,{POST:()=>POST});var o=t(884),i=t(6132),n=t(1610),a=t(2828),u=t(8802),p=t.n(u),l=t(6721),c=t.n(l),d=t(428),m=t(5798);async function POST(e=d.Z){try{let r=await e.json(),{email:t,password:s}=r,o=await a.Z.findOne({email:t});if(!o)return m.Z.json({error:"Invalid Credintials!"});let i=await p().compare(s,o.password);if(!i)return m.Z.json({error:"Invalid Credintials!"});let n={id:o._id,username:o.username,email:o.email},u=c().sign(n,process.env.TOKEN_SECRET,{expiresIn:"10d"}),l=m.Z.json({message:"Login successfull!",status:!0});return l.cookies.set("token",u,{httpOnly:!0}),l}catch(e){return m.Z.json({error:e.message},{status:500})}}(0,n.connect)();let g=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/users/login/route",pathname:"/api/users/login",filename:"route",bundlePath:"app/api/users/login/route"},resolvedPagePath:"E:\\WebProjects\\online-tutor\\src\\app\\api\\users\\login\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:_,serverHooks:v,headerHooks:f,staticGenerationBailout:P}=g,j="/api/users/login/route"}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[126,107,428,721,798],()=>__webpack_exec__(4653));module.exports=t})();